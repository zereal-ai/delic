{:tasks
 {;; Development REPL with Portal and CIDER middleware
  repl {:doc "Start development REPL with Portal and CIDER middleware"
        :override-builtin true
        :task (shell "clj -M:dev -m nrepl.cmdline --interactive --middleware '[cider.nrepl/cider-middleware]'")}

  ;; Static analysis with clj-kondo
  lint {:doc "Run clj-kondo static analysis"
        :task (shell "clj -M:lint")}

  ;; Comprehensive diagnostics with clojure-lsp
  diagnose {:doc "Run comprehensive diagnostics with clojure-lsp"
            :task (do
                    (println "ğŸ”¬ Running clojure-lsp diagnostics...")
                    (println "=====================================")
                    (let [result (shell {:continue true} "clojure-lsp diagnostics")]
                      (if (= 0 (:exit result))
                        (println "âœ… No diagnostics issues found")
                        (println "âš ï¸  Diagnostics completed with findings"))
                      (println)
                      (println "ğŸ’¡ Tip: Remove .lsp/.cache directory if you encounter issues")))}

  ;; Test suite with Kaocha
  test {:doc "Run test suite with Kaocha"
        :task (shell "clj -M:test")}

  ;; Build standalone uberjar
  uber {:doc "Build standalone uberjar"
        :task (shell "clj -T:build uber")}

  ;; Clean build artifacts
  clean {:doc "Clean build artifacts"
         :task (shell "clj -T:build clean")}

  ;; CI pipeline: lint + test
  ci {:doc "Run CI checks (lint + test)"
      :task (do
              (println "ğŸ—ï¸ Running CI Pipeline...")
              (println "========================")
              (print "ğŸ” Running lint... ")
              (let [lint-result (shell {:continue true} "clj -M:lint")]
                (if (= 0 (:exit lint-result))
                  (println "âœ… No issues found")
                  (println "âš ï¸  Warnings found (continuing)")))
              (println)
              (print "ğŸ§ª Running tests... ")
              (let [test-result (shell "clj -M:test")]
                (println "âœ… Tests completed"))
              (println)
              (println "ğŸ‰ CI Pipeline completed successfully!"))}

  ;; Enhanced CI pipeline with diagnostics
  ci-full {:doc "Run full CI checks (lint + diagnose + test)"
           :task (do
                   (println "ğŸ—ï¸ Running Full CI Pipeline...")
                   (println "==============================")
                   (print "ğŸ” Running lint... ")
                   (let [lint-result (shell {:continue true} "clj -M:lint")]
                     (if (= 0 (:exit lint-result))
                       (println "âœ… No issues found")
                       (println "âš ï¸  Warnings found (continuing)")))
                   (println)
                   (print "ğŸ”¬ Running diagnostics... ")
                   (let [diag-result (shell {:continue true} "clojure-lsp diagnostics")]
                     (if (= 0 (:exit diag-result))
                       (println "âœ… No issues found")
                       (println "âš ï¸  Diagnostics found (continuing)")))
                   (println)
                   (print "ğŸ§ª Running tests... ")
                   (let [test-result (shell "clj -M:test")]
                     (println "âœ… Tests completed"))
                   (println)
                   (println "ğŸ‰ Full CI Pipeline completed successfully!"))}

  ;; Enhanced help with better formatting
  help {:doc "Show available tasks"
        :override-builtin true
        :task (do
                (println "ğŸš€ desic - Available Babashka Tasks")
                (println "========================================")
                (println "ğŸ“–  help  - Show this help message")
                (println "ğŸ”„  repl  - Start development REPL with Portal and CIDER")
                (println "ğŸ”  lint  - Run clj-kondo static analysis")
                (println "ğŸ”¬  diagnose - Run comprehensive diagnostics with clojure-lsp")
                (println "ğŸ§ª  test  - Run test suite with Kaocha")
                (println "ğŸ“¦  uber  - Build standalone uberjar")
                (println "ğŸ§¹  clean - Clean build artifacts")
                (println "ğŸ—ï¸   ci    - Run CI checks (lint + test)")
                (println "ğŸ”¬  ci-full - Run full CI checks (lint + diagnose + test)")
                (println)
                (println "Usage: bb <task-name>")
                (println "Example: bb test"))}

  ;; Quick status check
  status {:doc "Show project status"
          :task (do
                  (println "ğŸ“Š desic Project Status")
                  (println "======================")
                  (print "ğŸ“ Directory: ")
                  (println (System/getProperty "user.dir"))
                  (print "ğŸ“‹ Dependencies: ")
                  (println (if (.exists (java.io.File. "deps.edn")) "âœ… deps.edn found" "âŒ deps.edn missing"))
                  (print "ğŸ”§ Build config: ")
                  (println (if (.exists (java.io.File. "build.clj")) "âœ… build.clj found" "âŒ build.clj missing"))
                  (print "ğŸ§ª Test status: ")
                  (println (if (.exists (java.io.File. "tests.edn")) "âœ… tests.edn found" "âŒ tests.edn missing")))}

  ;; Watch mode for tests (bonus feature)
  test-watch {:doc "Run tests in watch mode"
              :task (shell "clj -M:test --watch")}

  ;; REPL with just Portal (lighter weight)
  repl-simple {:doc "Start simple REPL with Portal only"
               :task (shell "clj -M:dev")}}}